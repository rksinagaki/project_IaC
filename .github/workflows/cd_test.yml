name: OIDC Authentication Test
on:
  push:
    branches:
      - feature/DQ
  workflow_dispatch:

jobs:
  test_auth:
    runs-on: ubuntu-latest
    
    permissions:
      id-token: write 
      contents: read
    
    steps:
      - name: ã‚³ãƒ¼ãƒ‰ã®ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ (å¿…é ˆã§ã¯ãªã„ãŒæ…£ä¾‹ã¨ã—ã¦å«ã‚ã‚‹)
        uses: actions/checkout@v4

      # --- èªè¨¼ãƒ†ã‚¹ãƒˆã®æ ¸å¿ƒ ---
      - name: ğŸ”‘ AWSèªè¨¼æƒ…å ±ã®æ§‹æˆ (OIDC)ã‚’è©¦è¡Œ
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: ${{ secrets.AWS_IAM_ROLE_ARN }}
          aws-region: ${{ secrets.AWS_REGION }}

      - name: âœ… èªè¨¼æˆåŠŸã®ç¢ºèª (ãƒ†ã‚¹ãƒˆç”¨ã‚³ãƒãƒ³ãƒ‰)
        run: |
          echo "Successfully assumed the role!"
          aws sts get-caller-identity